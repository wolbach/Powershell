$Prog = 0;

$Dienst = Read-Host "Nach welchen Typ soll gesucht werden? (AD,RDS,SQL)"

<# if ($Dienst -eq "ad") {
    $Dienst = "ActiveDirectory"
}
elseif ($Dienst -eq "rds") {
    $Dienst = "Remotedesktopdienste"
}
elseif ($Dienst -eq "SQL") {
    $Dienst = "SQL"
}
else {
    Writ-Host "Falsche Eingabe!"
    $Dienst = $null
} #>

$LogName = Read-Host "Art des Logs?"
$Type = Read-Host "Fehler/Warnung oder Informationen?"
$remcomp = Read-Host "Von Remote-Computer auslesen? (y/n)"

if ($remcomp -eq "y") {
    $comp = Read-Host "Wie ist der Name des Computers?"
}else {
    $comp = HOSTNAME.EXE
}

$Logs = @(Get-EventLog -ComputerName $comp -EntryType $Type -LogName $LogName -Source $Dienst)

foreach ($Log in $Logs) {

    Track-Progress -Message "Erstellen der Log-Datei" -StepNumber ($Prog++)
    $Log | Out-File -FilePath ./test.txt
}

function Track-Progress {
    param(
        [int]$StepNumber,
        [string]$Message
    )
    $script:steps = ([System.Management.Automation.PsParser]::Tokenize((gc "$PSScriptRoot\$($MyInvocation.MyCommand.Name)"), [ref]$null) | where { $_.Type -eq 'Command' -and $_.Content -eq 'Track-Progress' }).Count
    
    Write-Progress -Activity 'Title' -Status $Message -PercentComplete (($StepNumber / $steps) * 100)
}